# SEO Auditor - Render Blueprint
#
# Deploys the frontend and API service. Choose either TypeScript or Python backend.
# NOTE: Render Workflows are created via the Dashboard, not render.yaml.
# See README.md for workflow setup instructions.

services:
  # Frontend (static site)
  - type: web
    name: seo-audit-frontend
    runtime: static
    rootDir: frontend
    buildCommand: npm install && npm run build
    staticPublishPath: dist
    envVars:
      - key: VITE_API_URL
        fromService:
          name: seo-audit-api
          type: web
          property: host
      - key: NODE_VERSION
        value: "22"
    routes:
      - type: rewrite
        source: /*
        destination: /index.html

  # API service (TypeScript)
  - type: web
    name: seo-audit-api
    runtime: node
    plan: starter
    rootDir: typescript
    buildCommand: npm install && npm run build
    startCommand: node dist/api/index.js
    envVars:
      - key: RENDER_API_KEY
        sync: false
      - key: WORKFLOW_SLUG
        sync: false
      - key: WORKFLOW_ID
        sync: false
      - key: NODE_VERSION
        value: "22"

  # ─────────────────────────────────────────────────────────────────────────────
  # ALTERNATIVE: Python API (uncomment below and comment out TypeScript above)
  # ─────────────────────────────────────────────────────────────────────────────
  # - type: web
  #   name: seo-audit-api
  #   runtime: python
  #   plan: starter
  #   rootDir: python
  #   buildCommand: pip install -r requirements.txt
  #   startCommand: gunicorn --chdir api app:app
  #   envVars:
  #     - key: RENDER_API_KEY
  #       sync: false
  #     - key: WORKFLOW_SLUG
  #       sync: false # Set to your workflow slug (name) from the Dashboard
  #     - key: WORKFLOW_ID
  #       sync: false
  #     - key: PYTHON_VERSION
  #       value: "3.12"
